<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Report Card</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .report-card {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border: 6px solid #000;
            padding: 20px;
        }

        .header {
            display: flex;
            align-items: center;
            border-bottom: 2px solid #000;
            margin-bottom: 10px;
        }

        .logo {
            width: 140px;
            height: 140px;
        }

        .logo img {
            height: 100%;
        }

        .school-info {
            flex: 1;
        }

        .school-name {
            font-size: 25px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .school-details {
            font-size: 17px;
            line-height: 1.4;
        }

        .exam-info {
            text-align: center;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }

        .exam-info .session{
            font-size: 16px;
            font-weight: bold;
        }

        .exam-title {
            background: #e9ecef;
            border: 1px solid #000;
            padding: 8px;
            font-size: 16px;
            font-weight: bold;
            display: inline-block;
            /* margin-bottom: 10px; */
        }

        .student-info {
            display: flex;
            margin-bottom: 10px;
            align-items: center;
            gap: 10px;
        }

        .student-details {
            flex: 1;
            border: 1px solid #000;
            border-radius: 10px;
            padding: 15px;
            margin: 0px auto;
        }

        .student-details table {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .student-details td {
            padding: 2px 0;
            font-size: 14px;
        }

        /* .student-details td:first-child {
            font-weight: bold;
            width: 100px;
        } */

        .student-details td:nth-child(1),
        .student-details td:nth-child(4),
        .student-details td:nth-child(7),
        .student-details td:nth-child(10) {
            font-weight: bold;
        }

         .student-details td:nth-child(4),
        .student-details td:nth-child(9) {
            padding-left: 40px;
        }

        .student-avatar img {
            width: 100px;
            height: auto;
        }

        .grades-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .grades-table th,
        .grades-table td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
            font-size: 12px;
        }

        .grades-table th {
            color: #000;
            font-weight: bold;
        }

        .grades-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .summary-section {
            display: flex;
            margin-bottom: 20px;
            gap: 20px;
        }

        .summary-table {
            border-collapse: collapse;
            flex: 1;
        }

        .summary-table td {
            font-size: 15px;
            border: 1px solid #000;
            padding: 4px 5px;
            font-weight: bold;
            color: #000;
        }

        .icons-section {
            display: none;
            /* display: flex;
            gap: 10px; */
        }

        .icon-item {
            display: flex;
            padding-top: 5px;
            font-size: 12px;
            border: 1px solid #000;
        }

        .icon {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }

        .bottom-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 70px;
        }

        .teacher-remarks {
            flex: 1;
        }

        .remarks-box {
            border: 1px solid #000;
            height: 200px;
            padding: 10px;
            background: #f8f9fa;
        }

        .chart-section {
            flex: 1;
        }

        .chart-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 17px;
        }

        .chart {
            display: flex;
            align-items: end;
            height: 200px;
            gap: 15px;
            padding: 20px;
            border: 1px solid #000;
        }

        .bar {
            flex: 1;
            background: #060078;
            min-height: 20px;
            position: relative;
        }

        .bar-label {
            position: absolute;
            /* keep the label centered on the bar, but rotate it vertically */
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%) rotate(-70deg);
            transform-origin: center;
            white-space: nowrap;
            text-align: center;
            font-size: 5px;
        }

        .bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
        }

        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .signature {
            text-align: center;
            font-size: 15px;
            font-weight: bold;
        }

        .signature-line {
            width: 200px;
            border-bottom: 2px solid #000;
            margin-bottom: 5px;
            height: 20px;
        }

        @media print {
            body {
                padding: 0;
                background: white;
            }

            .report-card {
                box-shadow: none;
                border: none;
            }

            .bar {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
                background: #060078 !important;
            }

            .grades-table th {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
                background: #f8f9fa !important;
            }

            .grades-table tr:nth-child(even) {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
                background: #f8f9fa !important;
            }
        }
    </style>
</head>
<body>
    <div class="report-card">
        <!-- Header -->
        <div class="header">
            <div class="logo"><img src="./img/logo.jpg" alt=""></div>
            <div class="school-info">
                <div class="school-name">THE WISER SCHOOL SYSTEM & ACADEMY</div>
                <div class="school-details">
                    Lala Zar Colony Bara Dari Road Shahdara Lahore PH: 0320-9514171
                </div>
            </div>
        </div>

        <!-- Exam Info -->
        <div class="exam-info">
            <div class="exam-title" id="examTitle"></div>
            <div class="session" id="session"></div>
        </div>

        <!-- Student Info -->
        <div class="student-info">
            <div class="student-details">
                <table>
                    <tr>
                        <td>Class</td>
                        <td>:</td>
                        <td id="studentClass"></td>

                        <td>Student Name</td>
                        <td>:</td>
                        <td id="studentName"></td>

                        
                    </tr>
                    <tr>
                        <td>Father Name</td>
                        <td>:</td>
                        <td id="fatherName"></td>

                        <td>Position</td>
                        <td>:</td>
                        <td><input type="number" id="studentPosition" style="width: 60px; border: none; background: transparent;" min="1"></td>
                        <!-- <td>Student Name</td>
                        <td>:</td>
                        <td id="studentName"></td> -->
                    </tr>
                    <tr>
                        <!-- <td>Father Name</td>
                        <td>:</td>
                        <td id="fatherName"></td> -->
                    </tr>
                    <tr>
                        <!-- <td>Position</td>
                        <td>:</td>
                        <td><input type="number" id="studentPosition" style="width: 60px; border: none; background: transparent;" min="1"></td> -->
                    </tr>
                </table>
            </div>
            <div class="student-avatar"><img src="./img/student.webp" alt=""></div>
        </div>

        <!-- Grades Table -->
        <table class="grades-table">
            <thead>
                <tr>
                    <th>S#</th>
                    <th>Subjects</th>
                    <th>Total Marks</th>
                    <th>Obt Marks</th>
                    <th>Per%</th>
                    <th>Grade</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="gradesTableBody">
            </tbody>
        </table>

        <!-- Summary Section -->
        <div class="summary-section">
            <table class="summary-table">
                <tr>
                    <td>Total</td>
                    <td>Obtained</td>
                    <td>Percentage</td>
                    <td>Grade</td>
                    <td>Status</td>
                </tr>
                <tr>
                    <td id="totalMarks"></td>
                    <td id="totalObtained"></td>
                    <td id="totalPercentage"></td>
                    <td id="overallGrade"></td>
                    <td id="overallStatus"></td>
                </tr>
            </table>

            <div class="icons-section">
                <div class="icon-item">
                    <div class="icon">‚úçÔ∏è</div>
                    <span>Hand Writing</span>
                </div>
                <div class="icon-item">
                    <div class="icon">üëî</div>
                    <span>Uniform</span>
                </div>
                <div class="icon-item">
                    <div class="icon">üìö</div>
                    <span>Home Work</span>
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="bottom-section">
            <div class="teacher-remarks">
                <div class="chart-title">Teacher Remarks</div>
                <div class="remarks-box"></div>
            </div>

            <div class="chart-section">
                <div class="chart-title">Subject Performance</div>
                <div class="chart" id="performanceChart">
                </div>
            </div>
        </div>

        <!-- Signatures -->
        <div class="signatures">
            <div class="signature">
                <div class="signature-line"></div>
                <div>Principal Signature</div>
            </div>
            <div class="signature">
                <div class="signature-line"></div>
                <div>Vice Principal Signature</div>
            </div>
        </div>
    </div>

    <script>
        function calculateGrade(percentage) {
            if (percentage >= 90) return 'A+';
            if (percentage >= 80) return 'A';
            if (percentage >= 70) return 'B';
            if (percentage >= 60) return 'C';
            if (percentage >= 50) return 'D';
            if (percentage >= 40) return 'E';
            return 'F';
        }

        function calculateStatus(percentage) {
            return percentage >= 50 ? 'Pass' : 'Fail';
        }

        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        
        // Get form data from URL parameters
        const classValue = urlParams.get('class');
        const name = urlParams.get('name');
        const fatherName = urlParams.get('father_name');
        const term = urlParams.get('term');
        const year = urlParams.get('year');
        const subjects = urlParams.getAll('subjects[]');
        const totalMarks = urlParams.getAll('total_marks[]').map(Number);
        const obtainedMarks = urlParams.getAll('obtained_marks[]').map(Number);

        // Calculate grades and percentages
        let totalObtained = 0;
        let totalMax = 0;
        const grades = [];
        const statuses = [];
        const percentages = [];

        for (let i = 0; i < subjects.length; i++) {
            const percentage = (obtainedMarks[i] / totalMarks[i]) * 100;
            totalObtained += obtainedMarks[i];
            totalMax += totalMarks[i];
            percentages.push(percentage);
            grades.push(calculateGrade(percentage));
            statuses.push(calculateStatus(percentage));
        }

        const overallPercentage = (totalObtained / totalMax) * 100;
        const overallGrade = calculateGrade(overallPercentage);
        const overallStatus = calculateStatus(overallPercentage);

        // Update report card
        document.getElementById('examTitle').textContent = `${term} Term Exam`;
        document.getElementById('session').textContent = `Session: ${year}-${parseInt(year) + 1}`;
        document.getElementById('studentClass').textContent = classValue;
        document.getElementById('studentName').textContent = name;
        document.getElementById('fatherName').textContent = fatherName;

        // Update grades table
        const gradesTableBody = document.getElementById('gradesTableBody');
        for (let i = 0; i < subjects.length; i++) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${i + 1}</td>
                <td>${subjects[i]}</td>
                <td>${totalMarks[i]}</td>
                <td>${obtainedMarks[i]}</td>
                <td>${percentages[i].toFixed(1)}%</td>
                <td>${grades[i]}</td>
                <td>${statuses[i]}</td>
            `;
            gradesTableBody.appendChild(row);
        }

        // Update summary
        document.getElementById('totalMarks').textContent = totalMax;
        document.getElementById('totalObtained').textContent = totalObtained;
        document.getElementById('totalPercentage').textContent = `${overallPercentage.toFixed(1)}%`;
        document.getElementById('overallGrade').textContent = overallGrade;
        document.getElementById('overallStatus').textContent = overallStatus;

        // Update performance chart
        const chart = document.getElementById('performanceChart');
        for (let i = 0; i < subjects.length; i++) {
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.height = `${percentages[i]}%`;
            bar.innerHTML = `
                <div class="bar-value">${percentages[i].toFixed(1)}%</div>
                <div class="bar-label">${subjects[i]}</div>
            `;
            chart.appendChild(bar);
        }

        // Print the report card
        window.onload = function() {
            window.print();
        }
    </script>
</body>
</html> 
